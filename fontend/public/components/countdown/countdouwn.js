'use strict'; angular.module('shopnxApp') .directive('countDown', ['Util', '$interval', function (Util, $interval) {return {restrict: 'E', transclude: true, scope: {date: '=date'}, link: function (scope, element, attribute) {scope.$watch('date',function(data) {var future, diff; data && (future = new Date(data), $interval(function () {diff = Math.floor((future.getTime() - new Date().getTime()) / 1000), element.text(Util.dhms(diff)) }, 1) ) }); } }; } ]) .factory('Util', [function () {return {dhms: function (t) {if(t < 0) return '0 giây'; var days, hours, minutes, seconds; days = Math.floor(t / 86400); t -= days * 86400; hours = Math.floor(t / 3600) % 24; t -= hours * 3600; minutes = Math.floor(t / 60) % 60; t -= minutes * 60; seconds = t % 60; return [days > 0 ? days + ' ngày' : '', hours > 0 ? hours + ' giờ' : '', minutes > 0 ? minutes + ' phút' : '', seconds > 0 ? seconds + ' giây' : '0 giây'].join(' '); } }; }])