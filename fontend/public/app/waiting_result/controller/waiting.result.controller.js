'use strict';angular.module('shopnxApp').controller('WaitingResultCtrl',function($scope,$rootScope,$stateParams,socket,$interval,Product){$rootScope.parmas={aheadapps:true,cartapps:false,customer_share:false,forum:false,help:false,home:false,productapps:false,profileapps:false,restricted_area:false,waiting_result:true};$rootScope.stateParams=$stateParams;$rootScope.url_result='/api/products/get-product-result-new/'+$stateParams.slug;$rootScope.isPageProduct=false;$rootScope.isHomePage=false;$rootScope.hasCateg=true;$scope.countLottery={number:0};var getCountLotteryCategory=function(){Product.getCountLotteryCategory.get({slug:$stateParams.slug}).$promise.then(function(result){$scope.countLottery=result})};getCountLotteryCategory();socket.socket.on("product:hook_list_result",function(item){if($scope.page===0){var oldItem=_.find($scope.products,function(value){return value.product.session_id===item[0].product.session_id});typeof oldItem==='undefined'&&$scope.products.pop();oldItem?$scope.products.splice($scope.products.indexOf(oldItem),1,item[0]):$scope.products.unshift(item[0]);_.size($scope.products)>24&&typeof oldItem==='undefined'&&$scope.products.pop()}});socket.socket.on("product:hook_refresh_number",function(number){getCountLotteryCategory()});var md=new MobileDetect(window.navigator.userAgent);$scope.doTheBack=function(){window.history.back()};$scope.isMobile=false;$scope.isnotMobile=true;if(md.mobile()!=null){$scope.isMobile=true;$scope.isnotMobile=false}}).controller('WaitingResultAllCtrl',function($scope,$rootScope,$stateParams,socket,$interval,Product,Auth){$rootScope.parmas={aheadapps:true,cartapps:false,customer_share:false,forum:false,help:false,home:false,productapps:false,profileapps:false,restricted_area:false,waiting_result:true};$rootScope.stateParams=$stateParams;$rootScope.hasCateg=false;$rootScope.isHomePage=false;$rootScope.url_result='/api/products/get-product-result-new-all';$rootScope.isPageProduct=false;$scope.countLottery={number:0};Product.getCountLottery.get().$promise.then(function(result){$scope.countLottery=result});Auth.isLoggedInAsync(function(cb){$rootScope.isLoggedIn=cb;$rootScope.isAdmin=Auth.isAdmin();cb&&($rootScope.getCurrentUser=Auth.getCurrentUser(),$rootScope.countWaiting&&(Auth.resetNotifyMess({_id:$rootScope.getCurrentUser._id,type:'waiting_result'}).then(function(result){})))});socket.socket.on("product:hook_list_result",function(item){if($scope.page===0){var oldItem=_.find($scope.products,function(value){return value.product.session_id===item[0].product.session_id});oldItem?$scope.products.splice($scope.products.indexOf(oldItem),1,item[0]):$scope.products.unshift(item[0]);_.size($scope.products)>24&&typeof oldItem==='undefined'&&$scope.products.pop()}});socket.socket.on("product:hook_refresh_number",function(number){$scope.countLottery.number=number});var md=new MobileDetect(window.navigator.userAgent);$scope.doTheBack=function(){window.history.back()};$scope.isMobile=false;$scope.isnotMobile=true;if(md.mobile()!=null){$scope.isMobile=true;$scope.isnotMobile=false}});