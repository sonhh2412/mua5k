'use strict'; angular.module('shopnxApp') .controller('UpdateavatarCtrl', function($scope,Auth,Upload,$location,$window, $rootScope) {$rootScope.isPageProduct = false; $rootScope.isHomePage = false; Auth.isLoggedInAsync(function(cb){if(!cb){$location.path('/dang-nhap.html'); }else{$scope.session = {}; $scope.err_server = {}; $scope.provideruser = Auth.getCurrentUser().provider; $scope.session = {_id : Auth.getCurrentUser()._id, avatar : Auth.getCurrentUser().avatar }; $scope.uploadPic = function(file) {file.upload = Upload.upload({url: '/api/users/'+$scope.session._id+'/uploadFile', data: {file: file }, }); file.upload.then(function(data){if (data.status == 200){$window.location.reload(); $scope.picFile = null; } }) .catch(function(err){if (err.status == 500) $scope.errorMsg = err.data; }); } } }); }) ;